#!/bin/zsh

# Script to run windows 10 with geforce 980gtx gpu ;)

# ./default.pa:load-module module-native-protocol-unix srbchannel=1 socket=/home/ivan/.pulse_server
# ./client.conf:default-server = unix:/home/ivan/.pulse_server

QEMU_PA_SAMPLES=1024 QEMU_PA_SERVER=localhost PULSE_SERVER=localhost QEMU_AUDIO_DRV=pa qemu-system-x86_64 \
-enable-kvm \
-m 8192 \
-smp cores=4,threads=2 -soundhw hda \
-cpu host,kvm=off \
-vga none -usb -usbdevice host:1e7d:2e22 -usbdevice host:046d:c32b \
-device virtio-scsi-pci,id=scsi \
-device vfio-pci,host=01:00.0,multifunction=on \
-device vfio-pci,host=01:00.1 \
-drive if=pflash,format=raw,readonly,file=/one/vm/ovmf_code_x64.bin \
-drive if=pflash,format=raw,file=/one/vm/ovmf_vars_x64.bin \
-drive file=/one/vm/libvirt/w10.qcow2,id=disk,format=qcow2,if=none,cache=writeback -device scsi-hd,drive=disk
