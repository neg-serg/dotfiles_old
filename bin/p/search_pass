#!/bin/bash
win_name="$1"
pwd_store_d=${HOME}/.password-store
pass_entry=$(find ${pwd_store_d} -name "*${win_name}*.gpg" | awk -F ${pwd_store_d}/ '{print $2}' | rev | cut -d "." -f 1 --complement | rev)
[[ -n $3 ]] && pass_entry=$3

font_sz_="18"
font="Pragmata Pro for Powerline bold ${font_sz_}"
mon_width_=$(xrandr -q |awk '/Screen/{print $8}')
gap_="70"

if [[ -z $pass_entry ]]; then
	echo "$(find $pwd_store_d -name "*.gpg" | awk -F $pwd_store_d/ '{print $2}' | rev | cut -d "." -f 1 --complement | rev)" > /tmp/pass_rofi_fifo
    rofi -show pass:~/bin/rofi/pass.sh \
    -font "${font}" -yoffset -22 -location 6 \
    -width $[mon_width_ - gap_] \
    -lines 10 -columns 4 \
    -p 'pass' >/dev/null 2>&1
elif [[ $(grep -c . <<<"${pass_entry}") > 1 ]]; then
	echo "$pass_entry" > /tmp/pass_rofi_fifo
    rofi -show pass:~/bin/rofi/pass.sh \
    -font "${font}" -yoffset -22 -location 6 \
    -width $[mon_width_ - gap_] \
    -lines 10 -columns 4 \
    -p 'pass' >/dev/null 2>&1
else
	~/bin/p/clip_pass $pass_entry
fi
