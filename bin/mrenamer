#!/bin/zsh

main(){
    data=$(albumdetails "$@")

    artist=$(echo "${data}"|grep "Artist"| cut -d ':' -f 2-|xargs)
    year=$(echo "${data}"|grep "Year"| cut -d ':' -f 2-|xargs)

    year=${year//990/x0}
    year=${year//991/x1}
    year=${year//992/x2}
    year=${year//993/x3}
    year=${year//994/x4}
    year=${year//995/x5}
    year=${year//996/x6}
    year=${year//997/x7}
    year=${year//998/x8}
    year=${year//999/x9}

    year=${year//000/x0}
    year=${year//001/x1}
    year=${year//002/x2}
    year=${year//003/x3}
    year=${year//004/x4}
    year=${year//005/x5}
    year=${year//006/x6}
    year=${year//007/x7}
    year=${year//008/x8}
    year=${year//009/x9}
    year=${year//010/xA}
    year=${year//011/xB}
    year=${year//012/xC}
    year=${year//013/xD}
    year=${year//014/xE}
    year=${year//015/xF}
    year=${year//016/xG}
    year=${year//017/xH}
    year=${year//018/xI}
    year=${year//019/xJ}
    year=${year//020/xK}
    album=$(echo "${data}"|grep "Album"| cut -d ':' -f 2-|xargs)

    result=$(builtin print "${artist}-[${year}]-${album}")
    src=$(echo "$(dirname $1)")
    mv "${src}" "${result}"
}

main "$@"
